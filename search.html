<html>
  <head>
    <link rel="stylesheet" type="text/css" href="/main.css">
    <link rel="stylesheet" type="text/css" href="main.css">
    <link href='http://fonts.googleapis.com/css?family=Cherry+Swash' rel='stylesheet' type='text/css'>
    <script src="http://d3js.org/d3.v3.min.js"></script>
    <script src="http://qrohlf.com/trianglify/trianglify.js"></script>
    <link rel="stylesheet" href="buttons.css">
    <title>seekbar</title>
  </head>
  <body>
    <script>
    var t = new Trianglify();
    var pattern = t.generate(document.body.clientWidth, document.body.clientHeight);
    document.body.setAttribute('style', 'background: ' + pattern.dataUrl + 'no-repeat center center fixed');
    //background: url(./res/img/table.jpg) no-repeat center center fixed;
    </script>
    <div id="boxen">
      <div class="box">
        <br><br><br><br><br><br><br><br>
        <ul id="products">

        </ul>
      </div>
    </div>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBd809o1TY1rGV_1vhZA22AiFJnOJhZJHk"></script>
    <script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script type="text/javascript">
    // when we implement the button that chooses a product,
    // socket.emit('product', name);
    // socket.on('stores', function(stores) {
    //
    // });

    var socket = io();

    var q = getUrlVars()["q"];
    var zip = getUrlVars()["zip"];

    socket.emit("search", q, zip);

    socket.on('results', function(products) {
      for (var i = 0; i < products.length; i++) {
        $('#products').append("<li>" + products[i].name + "<img src='" + products[i].image + "'></li>");
      }
    });

    socket.on('stores', function(stores) {
      $("#boxen").prepend("<div class='box'><div id='map-canvas'></div></div>");
      function initialize() {
        var mapOptions = {
          center: { lat: 40.728796191042, lng: -73.99595872784677 },
          zoom: 8
        };
        var map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);
      }
      google.maps.event.addDomListener(window, 'load', initialize);
    });

    function getUrlVars() {
      var vars = {};
      var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,
      function(m,key,value) {
        vars[key] = value;
      });
      return vars;
    }
    </script>
  </body>
</html>
